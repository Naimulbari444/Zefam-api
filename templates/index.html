<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TikTok Bot Pro</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background: #0c0c0c; color: #fff; font-family: sans-serif; padding: 20px; }
        .main-card { max-width: 450px; margin: auto; background: #1a1a1a; padding: 25px; border-radius: 15px; border: 1px solid #333; }
        h3 { color: #00ff88; text-align: center; font-weight: bold; margin-bottom: 20px; text-transform: uppercase; }
        label { color: #00ff88; font-weight: bold; font-size: 13px; margin-bottom: 5px; display: block; }
        .form-control, .form-select { background: #252525 !important; border: 1px solid #444 !important; color: #ffffff !important; padding: 12px; margin-bottom: 15px; }
        .form-control::placeholder { color: #aaaaaa !important; }
        .btn-run { background: #00ff88; color: #000; font-weight: bold; width: 100%; padding: 12px; border: none; border-radius: 8px; }
        .btn-stop { background: #ff4444; color: #fff; font-weight: bold; width: 100%; padding: 12px; border: none; border-radius: 8px; display: none; }
        .log-box { background: #000; color: #00ff88; height: 200px; overflow-y: auto; border: 1px solid #333; padding: 10px; font-family: monospace; font-size: 12px; border-radius: 8px; margin-top: 20px; }
        .status { text-align: center; font-size: 14px; margin-bottom: 10px; }
    </style>
</head>
<body>
<div class="main-card">
    <h3>TIKTOK BOT PRO</h3>
    <div class="status">System: <span id="st-text" class="text-danger">IDLE</span></div>
    <form id="botForm">
        <label>SERVICE TYPE</label>
        <select id="sid" class="form-select">
            {% for s in services %}
            <option value="{{ s.id }}">{{ s.name }} â€” [{{ s.status }}]</option>
            {% endfor %}
        </select>
        <label>VIDEO LINK</label>
        <input type="url" id="link" class="form-control" placeholder="Paste TikTok link here..." required>
        <label>TARGET AMOUNT</label>
        <input type="number" id="trgt" class="form-control" placeholder="Example: 100">
        <button type="submit" id="btn" class="btn-run">START PROCESS</button>
    </form>
    <button id="stopBtn" onclick="stopBot()" class="btn-stop">STOP BOT</button>
    <div id="logs" class="log-box">> Waiting for command...</div>
</div>
<script>
    async function update() {
        const r = await fetch('/get_logs');
        const d = await r.json();
        document.getElementById('logs').innerHTML = d.logs.map(x => `<div>> ${x}</div>`).join('');
        const lb = document.getElementById('logs'); lb.scrollTop = lb.scrollHeight;
        if(d.is_running) {
            document.getElementById('st-text').innerText = "RUNNING (Keep-Alive: 3m)";
            document.getElementById('btn').style.display = "none";
            document.getElementById('stopBtn').style.display = "block";
        } else {
            document.getElementById('st-text').innerText = "IDLE";
            document.getElementById('btn').style.display = "block";
            document.getElementById('stopBtn').style.display = "none";
        }
    }
    document.getElementById('botForm').onsubmit = async (e) => {
        e.preventDefault();
        const f = new FormData();
        f.append('service_id', document.getElementById('sid').value);
        f.append('video_link', document.getElementById('link').value);
        f.append('target', document.getElementById('trgt').value);
        await fetch('/start', { method: 'POST', body: f });
        setInterval(update, 3000);
    };
    async function stopBot() {
        await fetch('/stop', { method: 'POST' });
        update();
    }
    setInterval(update, 5000);
</script>
</body>
</html>
